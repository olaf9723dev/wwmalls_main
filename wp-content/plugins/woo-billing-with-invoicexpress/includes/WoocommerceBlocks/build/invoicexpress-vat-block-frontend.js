(()=>{var e={967:(e,t)=>{var o;!function(){"use strict";var n={}.hasOwnProperty;function a(){for(var e="",t=0;t<arguments.length;t++){var o=arguments[t];o&&(e=c(e,s(o)))}return e}function s(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return a.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var o in e)n.call(e,o)&&e[o]&&(t=c(t,o));return t}function c(e,t){return t?e?e+" "+t:e+t:e}e.exports?(a.default=a,e.exports=a):void 0===(o=function(){return a}.apply(t,[]))||(e.exports=o)}()}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,o),s.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wc.blocksCheckout,t=window.React;var n=o(967),a=o.n(n);const s=window.wp.i18n,c=window.wp.element,r=window.wp.data,i=window.wc.wcBlocksData,l=window.wc.wcSettings,{defaultLabel:p,defaultIsRequired:d,defaultValidate:u}=(0,l.getSetting)("invoicexpress_vat_data",""),m={lock:{type:"object",default:{move:!1,remove:!0}},className:{type:"string",default:""},stepTitle:{type:"string",default:(0,s.__)("Fiscal information","woo-billing-with-invoicexpress")},stepDescription:{type:"string",default:""},showStepNumber:{type:"boolean",default:!0},label:{type:"string",default:p},isRequired:{type:"boolean",default:d},validate:{type:"boolean",default:u}},w=({title:e,stepHeadingContent:o})=>(0,t.createElement)("div",{className:"wc-block-components-checkout-step__heading"},(0,t.createElement)("h2",{"aria-hidden":"true",className:"wc-block-components-checkout-step__title wc-block-components-title"},e),!!o&&(0,t.createElement)("span",{className:"wc-block-components-checkout-step__heading-content"},o)),b=({title:e="",description:o="",showStepNumber:n=!0,className:s="",children:c,stepHeadingContent:r=(()=>{})})=>{const i=e?"fieldset":"div";return(0,t.createElement)(i,{className:a()(s,"wc-block-components-checkout-step",{"wc-block-components-checkout-step--with-step-number":n})},e&&(0,t.createElement)("legend",{className:"screen-reader-text"},e),e&&(0,t.createElement)(w,{title:e,stepHeadingContent:r()}),(0,t.createElement)("div",{className:"wc-block-components-checkout-step__container"},o&&(0,t.createElement)("p",{className:"wc-block-components-checkout-step__description"},o),(0,t.createElement)("div",{className:"wc-block-components-checkout-step__content"},c)))},f="invoicexpress_vat",v="invoicexpress-vat-invalid",h=(g=m,e=>o=>{const n=((e,t)=>{const o=[];return Object.keys(e).forEach((n=>{if(void 0!==t[n])switch(e[n].type){case"boolean":o[n]="false"!==t[n]&&!1!==t[n];break;case"number":o[n]=parseInt(t[n],10);break;case"array":case"object":o[n]=JSON.parse(t[n]);break;default:o[n]=t[n]}else o[n]=e[n].default})),o})(g,o);return(0,t.createElement)(e,{...o,...n})})((o=>{const{stepTitle:n,stepDescription:l,showStepNumber:p,label:d,isRequired:u,validate:m,className:w,validation:{setValidationErrors:h,getValidationError:g,clearValidationError:k}}=o,{extensions:_,billingCountry:y}=(0,r.useSelect)((e=>{const t=e(i.CART_STORE_KEY),{extensions:o,billingAddress:n}=t.getCartData(),{country:a}=n;return{billingCountry:a,extensions:o}})),{__internalIncrementCalculating:E,__internalDecrementCalculating:N}=(0,r.useDispatch)(i.CHECKOUT_STORE_KEY),[x,S]=(0,c.useState)(!1),[C,O]=(0,c.useState)(_[f]?.InvoiceXpressVat),[T,V]=(0,c.useState)(_[f]?.InvoiceXpressVat),I=g(v),L=!1===I?.hidden&&""!==I?.message,D=I?.message;(0,c.useEffect)((()=>(_[f]?.isValid?k(v):h({[v]:{message:(0,s.sprintf)((0,s.__)(/* translators: %s field label */
"Please enter a valid %s","woocommerce"),d),hidden:!1}}),()=>{k(v)})),[_[f],C]),(0,c.useEffect)((()=>{C!==T&&(E(),(0,e.extensionCartUpdate)({namespace:f,data:{InvoiceXpressVat:C,isRequired:u,validate:m},cartPropsToReceive:["extensions"]}).then((()=>{N(),V(C)})))}),[e.extensionCartUpdate,C,u,m,E,N,T,V]);const R=(0,c.useCallback)((e=>{k(v),0===e.length&&u&&h({[v]:{message:(0,s.sprintf)((0,s.__)(/* translators: %s field label */
"Please enter a valid %s","woocommerce"),d),hidden:!1}}),O(e)}),[O,k,h]);return(0,t.createElement)(b,{title:n,description:l,showStepNumber:p,className:w},(0,t.createElement)("div",{className:a()("wc-block-components-text-input",{"is-active":x||C},{"has-error":L})},(0,t.createElement)(e.ValidatedTextInput,{type:"text",id:"billing_VAT_code","aria-label":d,autoComplete:"on",required:u,onChange:R,onFocus:()=>S(!0),onBlur:()=>S(!1),"aria-invalid":!0===L,value:C||""}),(0,t.createElement)("label",{htmlFor:"billing_VAT_code"},(0,s.sprintf)("%s%s",d,!0===u?"":` ${(0,s.__)("(optional)","woocommerce")}`)),L&&(0,t.createElement)("div",{className:"wc-block-components-validation-error",role:"alert"},(0,t.createElement)("p",null,D))))}));var g;const k=JSON.parse('{"apiVersion":2,"name":"woocommerce/invoicexpress-vat","version":"0.1.0","title":"InvoiceXpress VAT","category":"woocommerce","description":"","supports":{"html":false,"align":false,"multiple":false,"reusable":false},"parent":["woocommerce/checkout-fields-block"],"attributes":{},"textdomain":"woo-billing-with-invoicexpress"}');(0,e.registerCheckoutBlock)({metadata:k,component:h}),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".wp-block-woocommerce-checkout");e&&new MutationObserver(((e,t)=>{for(const o of e)if("childList"===o.type&&o.addedNodes.length>0){const e=Array.from(o.addedNodes);let n=e.find((e=>e.classList&&e.classList.contains("wp-block-woocommerce-checkout-shipping-methods-block")));if(n||(n=e.find((e=>e.classList&&e.classList.contains("wp-block-woocommerce-checkout-payment-block")))),n){t.disconnect();const e=document.querySelector(".wp-block-woocommerce-invoicexpress-vat");e&&n.compareDocumentPosition(e)===Node.DOCUMENT_POSITION_FOLLOWING&&n.parentNode.insertBefore(e,n)}}})).observe(e,{childList:!0,subtree:!0})}))})()})();